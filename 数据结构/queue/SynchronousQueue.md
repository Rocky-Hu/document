尽管SynchronousQueue有一个队列接口，但我们应该把它看作是两个线程之间单个元素的交换点，其中一个线程正在传递一个元素，另一个线程正在接收该元素。

# 1. TransferStack

## mode

是存数据还是取数据

~~~
int mode = (e == null) ? REQUEST : DATA;
~~~

# put

插入数据，多个线程争抢头节点的设置，A线程抢成功设置头节点，若暂时无消费者线程，那么首先就开始自旋。

自旋多少次呢？

- 若CPU核数小于2，则自旋0次
- 若CPU核数大于等于2，则自旋512次

> 若设置了timeout，那么在自旋的时候可能会达到这个超时时间，达到了超时时间则停止自旋，并且不挂起线程。

达到了自旋最大次数，栈中数据还未被消费，则挂起线程。

## take

重置头元素。


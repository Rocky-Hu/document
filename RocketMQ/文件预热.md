# 文件预热

上述我们讲了mmap技术对消息写入的优化，事实上，对于消息读取，整个过程也只有一次数据拷贝而已，其过程如下：

1. 读取消息时，首先判断要读取的数据是否在PageCache里？如果在的话，直接从PageCache里读取；
2. 如果PageCache里没有，就会从磁盘文件里加载数据到PageCache中（这个过程利用mmap技术只需一次拷贝）；
3. PageCache在加载数据时，会将被加载数据的临近其它数据块也一起加载，提升命中率。

>  RocketMQ在提前进行内存映射后，还会提前将后面可能频繁读取的一些数据（比如CommitLog、ConsumeQueue文件），尽可能多的加载到PageCache中，这就是所谓的文件预热。


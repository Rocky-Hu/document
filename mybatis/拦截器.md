可对下面四种对象进行拦截：

- Executor
- StatementHandler
- ParameterHandler
- ResultSetHandler

# 原理

上面的四大对象，生成的是代理对象：

~~~
public ParameterHandler newParameterHandler(MappedStatement mappedStatement, Object parameterObject, BoundSql boundSql) {
	ParameterHandler parameterHandler = mappedStatement.getLang().createParameterHandler(mappedStatement, parameterObject, boundSql);
	parameterHandler = (ParameterHandler) interceptorChain.pluginAll(parameterHandler);
	return parameterHandler;
}

public ResultSetHandler newResultSetHandler(Executor executor, MappedStatement mappedStatement, RowBounds rowBounds, ParameterHandler parameterHandler,
  ResultHandler resultHandler, BoundSql boundSql) {
	ResultSetHandler resultSetHandler = new DefaultResultSetHandler(executor, mappedStatement, parameterHandler, resultHandler, boundSql, rowBounds);
	resultSetHandler = (ResultSetHandler) interceptorChain.pluginAll(resultSetHandler);
	return resultSetHandler;
}

public StatementHandler newStatementHandler(Executor executor, MappedStatement mappedStatement, Object parameterObject, RowBounds rowBounds, ResultHandler resultHandler, BoundSql boundSql) {
	StatementHandler statementHandler = new RoutingStatementHandler(executor, mappedStatement, parameterObject, rowBounds, resultHandler, boundSql);
	statementHandler = (StatementHandler) interceptorChain.pluginAll(statementHandler);
	return statementHandler;
}

public Executor newExecutor(Transaction transaction) {
	return newExecutor(transaction, defaultExecutorType);
}
~~~

org.apache.ibatis.plugin.InterceptorChain#pluginAll

~~~
public Object pluginAll(Object target) {
	for (Interceptor interceptor : interceptors) {
	  target = interceptor.plugin(target);
	}
	return target;
}
~~~

org.apache.ibatis.plugin.Interceptor#plugin

~~~
default Object plugin(Object target) {
    return Plugin.wrap(target, this);
}
~~~

org.apache.ibatis.plugin.Plugin#wrap

~~~
public static Object wrap(Object target, Interceptor interceptor) {
    Map<Class<?>, Set<Method>> signatureMap = getSignatureMap(interceptor);
    Class<?> type = target.getClass();
    Class<?>[] interfaces = getAllInterfaces(type, signatureMap);
    if (interfaces.length > 0) {
      return Proxy.newProxyInstance(
          type.getClassLoader(),
          interfaces,
          new Plugin(target, interceptor, signatureMap));
    }
    return target;
}
~~~


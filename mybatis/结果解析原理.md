# MySQL列类型和JdbcType的对应关系



# 执行流程

org.apache.ibatis.executor.resultset.DefaultResultSetHandler#handleRowValues

->
org.apache.ibatis.executor.resultset.DefaultResultSetHandler#handleRowValuesForSimpleResultMap

->

org.apache.ibatis.executor.resultset.DefaultResultSetHandler#getRowValue(org.apache.ibatis.executor.resultset.ResultSetWrapper, org.apache.ibatis.mapping.ResultMap, java.lang.String)

->



# Auto-mapping

https://mybatis.org/mybatis-3/sqlmap-xml.html#Auto-mapping

# TypeHandler是怎么确定的

![](../images/mybatis/TypeHandler.png)

org.apache.ibatis.executor.resultset.DefaultResultSetHandler#createAutomaticMappings

org.apache.ibatis.executor.resultset.ResultSetWrapper#getTypeHandler

~~~
handler = typeHandlerRegistry.getTypeHandler(propertyType, jdbcType);
~~~

## TypeHandlerRegistry

org.apache.ibatis.type.TypeHandlerRegistry

![](../images/mybatis/TypeHandlerRegistry.png)

这里很重要，当请求数据库时，获得的是数据的Java类型，该Java类型在通过JDBC驱动设值时，是rs.setInt()还是其它的呢？这里就确定了，Java类型用什么样的TypeHander处理。通过当我们处理结果时，JDBC驱动会得到列对应的JDBC Type，那么这时候是rs.getInt()还是其他的呢，这里应该注册了JdbcType对应的TypeHander，所以也是可以确定的。

## TypeHandler的确定

org.apache.ibatis.executor.resultset.ResultSetWrapper#getTypeHandler

![](../images/mybatis/TypeHandler的确定.png)

## 列对应的Java类型的确定

![](../images/mybatis/结果集列对应的Java类型的确定.png)

## Java类型为Object，如何确定TypeHandler

![](../images/mybatis/属性为Object之TypeHandler确定.png)

# 整体逻辑

![](../images/mybatis/TypeHandleRegistry.png)


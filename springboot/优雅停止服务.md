~~~
When we stop a running application or a process the underlying operating system delivers a termination signal to the process. Without having enabled any mechanism for graceful shutdown a Spring Boot application will simply terminate as soon as it receives the signal.
~~~

优雅停机包括：线程池的优雅关闭，数据库连接池的关闭，数据源的关闭，kafka连接的关闭....

# 参考

org.springframework.boot.web.embedded.tomcat.GracefulShutdown#doShutdown

~~~
private void doShutdown(GracefulShutdownCallback callback) {
	List<Connector> connectors = getConnectors();
	connectors.forEach(this::close);
	try {
		for (Container host : this.tomcat.getEngine().findChildren()) {
			for (Container context : host.findChildren()) {
				while (isActive(context)) {
					if (this.aborted) {
						logger.info("Graceful shutdown aborted with one or more requests still active");
						callback.shutdownComplete(GracefulShutdownResult.REQUESTS_ACTIVE);
						return;
					}
					Thread.sleep(50);
				}
			}
		}

	}
	catch (InterruptedException ex) {
		Thread.currentThread().interrupt();
	}
	logger.info("Graceful shutdown complete");
	callback.shutdownComplete(GracefulShutdownResult.IDLE);
}
~~~

